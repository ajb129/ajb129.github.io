<html xmlns:fn="http://framenet.icsi.berkeley.edu"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>make;send</title>
<style type="text/css">
				table {
					border-width: medium medium medium medium;
					border-spacing: 2px;
					border-style: outset outset outset outset;
					border-color: gray gray gray gray;
					border-collapse: separate;
					background-color: white;
				}
				table th {
					border-width: 1px 1px 1px 1px;
					padding: 1px 1px 1px 1px;
					border-style: inset inset inset inset;
					border-color: gray gray gray gray;
					background-color: white;
					-moz-border-radius: 0px 0px 0px 0px;
				}
				table td {
					border-width: 1px 1px 1px 1px;
					padding: 1px 1px 1px 5px;
					border-style: inset inset inset inset;
					border-color: gray gray gray gray;
					background-color: white;
					-moz-border-radius: 0px 0px 0px 0px;
				}
				table.fes td.feName {
					width: 300px;
				}
				table.fes td.feType {
					width: 180px;
				}

                
				span.Target {
					color: #FFFFFF;
					background-color: #000000;
				}
				span.italic {
					font-style: italic;
				}
				span.Gov {
					font-weight: bold;
				}
				span.X {
					text-decoration: underline;
				}
				span.invisible {
					color: #FFFFFF;
					background-color: #FFFFFF;
				}
				
					span.Unk-arg0 {
						color: #000000;
						background-color: #FF69B4;
					}
					span.Unk-arg0 {
						color: #000000;
						background-color: #FF69B4;
					}
				
					span.Unk-arg1 {
						color: #000000;
						background-color: #D8BFD8;
					}
					span.Unk-arg1 {
						color: #000000;
						background-color: #D8BFD8;
					}
				
					span.Unk-prd {
						color: #000000;
						background-color: #87CEEB;
					}
					span.Unk-prd {
						color: #000000;
						background-color: #87CEEB;
					}
				</style>
<script type="text/javascript">
				//
                // Javascript must go in CDATA blocks to get it
                // through the XSL processor

				// GLOBAL VARIABLES
				var currentXMLFile = getURLFileName();
				//
				var frameName = "Unk";

                
                    //
                    var mode = gup('mode');
                    //
                
                //
                /* ANNOTATION MODE */
				// if mode isn't specified, display Annotation Report
				if (mode == "" || mode == "annotation") {
                    // create the HTML body
					var docBody = document.createElement("body");
					document.documentElement.appendChild(docBody);

                    //
                    
                        //
                        // create navigation links at top right of report
                        var linkDiv = navBar();
                        document.body.appendChild(linkDiv);
                        //
                    
                    //
                    // create the headings for the Annotation Report
                    var bodyHeading = document.createElement("h1");
                    bodyHeading.innerHTML = "Annotation";
                    var bodyTitle = document.createElement("h1");
					//
					bodyTitle.innerHTML = "make;send";
					//
                    document.body.appendChild(bodyHeading);
					document.body.appendChild(bodyTitle);

                    // create the FE Table
					var feTableDiv = document.createElement("div");
					feTableDiv.setAttribute("id","feTable");
					var feLegend = document.createElement("div");
					feLegend.setAttribute("class","fes");
					var rowStr;
					var tableContent = "<tr><th>Role</th></tr>";
					//
					
						//
						rowStr = "<tr>";
						rowStr += "<td class='feName'><span class='";
						//
						rowStr += "Unk-arg0";
						//
						rowStr += "'>";
						//
						rowStr += "arg0";
						//
						rowStr += "</span>";
						//
						//
						rowStr += "</td></tr>";
						tableContent += rowStr;
						//
					
						//
						rowStr = "<tr>";
						rowStr += "<td class='feName'><span class='";
						//
						rowStr += "Unk-arg1";
						//
						rowStr += "'>";
						//
						rowStr += "arg1";
						//
						rowStr += "</span>";
						//
						//
						rowStr += "</td></tr>";
						tableContent += rowStr;
						//
					
						//
						rowStr = "<tr>";
						rowStr += "<td class='feName'><span class='";
						//
						rowStr += "Unk-prd";
						//
						rowStr += "'>";
						//
						rowStr += "prd";
						//
						rowStr += "</span>";
						//
						//
						rowStr += "</td></tr>";
						tableContent += rowStr;
						//
					
					//
					feLegend.innerHTML = "<table>" + tableContent + "</table>";
					feTableDiv.appendChild(feLegend);
					document.body.appendChild(feTableDiv);

                    // turn colors on and set up the toggle colors link
                    var colors = 1;
                    //
                    
                        //
                        var buttonDiv = document.createElement("div");
                        buttonDiv.setAttribute("id","buttons");
                        // 'blur' code is to get rid of a dotted-line box around the link
                        buttonDiv.innerHTML = "<br /><a onFocus='if(this.blur)this.blur();' id='annotColorLink'" +
                            "href='javascript:toggleAnnotationColor()'>Turn Colors Off</a><br />";
                        document.body.appendChild(buttonDiv);
                        //
                    
                    //

                    // set up the divs for displaying sentences
                    var mainDivColor = document.createElement("div");
                    var mainDivNoColor = document.createElement("div");
                    mainDivColor.style.display = "block"; // display color div
                    mainDivNoColor.style.display = "none"; // hide no color div
                    document.body.appendChild(mainDivColor);
                    document.body.appendChild(mainDivNoColor);

                    // get sentences, color and mark them up, and add them to
                    // mainDivColor and mainDivNoColor
                    showAnnotation();

                    Array.prototype.contains = function ( needle ) {
                       for (i in this) {
                           if (this[i] == needle) return true;
                       }
                       return false;
                    }
                    
                    var labelsCByDiv = document.createElement("div");
                    var cBys = new Array();
                    var cBy = '';
                    //
                    
                    //
                    // labelsCByDiv.innerHTML = '<b>Annotator ID(s): </b>' + cBys.join(', ');
                    // document.body.appendChild(labelsCByDiv);

                    // called by toggle colors link
                    function toggleAnnotationColor() {
                        colors = 1 - colors;
                        if (colors == 1) {
                            document.getElementById('annotColorLink').innerHTML = "Turn Colors Off";
                            mainDivColor.style.display = "block"; // display color div
                            mainDivNoColor.style.display = "none"; // hide no color div
                        } else {
                            document.getElementById('annotColorLink').innerHTML = "Turn Colors On";
                            mainDivColor.style.display = "none"; // hide color div
                            mainDivNoColor.style.display = "block"; // display no color div
                        }
                    }
				} 
                
                /* LEXICAL ENTRY MODE */
                else if (mode == "lexentry") {
                    // create the frameset and two frames for the Lexical Entry
                    // Report and set their src as the currentXMLFile but with the
                    // mode set as 'lexentrytop' for the top frame
                    // and 'sentence' for the bottom frame
					var frameset = document.createElement("frameset");
					frameset.setAttribute("rows","60%,*");
					var mFrame = document.createElement("frame");
					mFrame.setAttribute("src",currentXMLFile+"?mode=lexentrytop");
					mFrame.setAttribute("name","top");
					frameset.appendChild(mFrame);
					var sFrame = document.createElement("frame");
					sFrame.setAttribute("src",currentXMLFile+"?mode=sentence");
					sFrame.setAttribute("name","bottom");
					frameset.appendChild(sFrame);
					document.documentElement.appendChild(frameset);
				}

                /* LEXICAL ENTRY MODE TOP FRAME */
                else if (mode == "lexentrytop") {
                    // track the sentences added to the bottom frame in an array
					var sentIDs = new Array();

                    // create a body for this frame
					var frameBody = document.createElement("body");
					document.documentElement.appendChild(frameBody);

                    //
                    
                        //
                        // create navigation links at top right of report
                        var linkDiv = navBar();
                        document.body.appendChild(linkDiv);
                        //
                    
                    //
                    // put all of the lexical entry data in a div with id 'main'
					var mainDiv = document.createElement("div");
					mainDiv.setAttribute("id","main");
					document.body.appendChild(mainDiv);

                    // get the lexical entry data and display in mainDiv
					showLexEntry("main");

					// entry point for adding a sentence to the bottom pane
                    // when user clicks a sentence count link
					function addSent(){
						for (var i=0; i < addSent.arguments.length; i++ ) {
							var sent_id = addSent.arguments[i];
							if (addSentID(sent_id)) {
                                // pass the sentID to the transformAndAdd function
                                // in the bottom sentence frame
								parent.frames[1].transformAndAdd(sent_id);
							}
						}
					}

                    // add a sentID to the array sentIDs
                    function addSentID(sent_id) {
						if (hasSentID(sent_id) < 0) {
							sentIDs.push(sent_id);
							return true;
						}
						else
							return false;
					}

                    // check if the sentID has already been added to the
                    // bottom sentence frame (is stored in sentIDs)
					function hasSentID(sent_id){
						for (var i = 0; i < sentIDs.length; i++)
							if (sentIDs[i] == sent_id)
								return i;
							return -1;
					}					

                    // remove a sentID from the array sentIDs
					function removeSentID(sent_id) {
						var pos = hasSentID(sent_id);
						if (pos >= 0) {
							if (pos < sentIDs.length - 1) {
								sentIDs[pos] = sentIDs.pop();
							} else {
								sentIDs.pop();
							}
							return true;
						}
						else {
							// Shouldn't get here
							return false;
						}
					}
				}

                /* LEXICAL ENTRY MODE BOTTOM SENTENCE FRAME */
                else if (mode == "sentence") {
                    // turn colors on
					var colors = 1;

                    // create divs for the colored and marked up sentences
					var sentDivC_On = document.createElement('div'); // colors
					var sentDivC_Off = document.createElement('div'); // no colors

					// generate the body of the document
					var docBody = document.createElement("body");
					document.documentElement.appendChild(docBody);
                    //
                    
                        //
                        var buttonDiv = document.createElement("div");
                        buttonDiv.setAttribute("id","buttons");
                        // 'blur' code is to get rid of a dotted-line box around the link
                        buttonDiv.innerHTML += "<a onFocus='if(this.blur)this.blur();'" +
                            "href='javascript:clearSents()'>Clear Sentences</a>";
                        buttonDiv.innerHTML += "<a onFocus='if(this.blur)this.blur();' style='padding:15px;' id='colorLink'" +
                            "href='javascript:toggleColor()'>Turn Colors Off</a><br /><br />";
                        document.body.appendChild(buttonDiv);
                        //
                    
                    //
                    // create a div for the display of sentences
					var sentsDiv = document.createElement("div");
					sentsDiv.setAttribute("id","sents");
					sentsDiv.appendChild(sentDivC_On);
					sentsDiv.appendChild(sentDivC_Off);
					document.body.appendChild(sentsDiv);

					function toggleColor() {
						colors = 1 - colors;
						showSents();
					}

					function showSents() {
						if (colors == 1) {
                            //
                            
                                //
                                document.getElementById('colorLink').innerHTML = "Turn Colors Off";
                                //
                            
                            //
							sentDivC_On.style.display = "block"; // display color div
							sentDivC_Off.style.display = "none"; // hide no color div
						} else {
                            //
                            
                                //
                                document.getElementById('colorLink').innerHTML = "Turn Colors On";
                                //
                            
                            //
							sentDivC_On.style.display = "none"; // hide color div
							sentDivC_Off.style.display = "block"; // display no color div
						}
					}

                    // used by the clear sentences link
					function clearSents() {
                        // delete html in sentence divs
						sentDivC_On.innerHTML = "";
						sentDivC_Off.innerHTML = "";
                        // reset the sentIDs array in the top frame
						parent.frames[0].sentIDs = new Array();
					}

                    // used by the [X] links to the left of sentences
					function removeSent(sent_id) {
                        // get the child of the sentence divs where the sentence
                        // with the given sentID is stored
						var nodeC_On = getChild(sentDivC_On, 'sent' + sent_id + 'C_On');
						var nodeC_Off = getChild(sentDivC_Off, 'sent' + sent_id + 'C_Off');

                        // if the children were found, remove them
						if (nodeC_On && nodeC_Off) {
							sentDivC_On.removeChild(nodeC_On);
							sentDivC_Off.removeChild(nodeC_Off);
                            // also update the sentIDs array in the top frame
							parent.frames[0].removeSentID(sent_id);
						}
					}

                    // find the child of an object by id
					function getChild(object, id){
						for (var i = 0; object.childNodes.item(i); i++){
							if (object.childNodes.item(i).id == id){
								return object.childNodes.item(i);
							}
						}
						return null;
					}

                    // color and mark up the sentences, then display them
                    // called by the top frame when a user clicks a sentence count link
					function transformAndAdd(sentId) {
                        // color and mark up sentence with ID 'sentId'
						sent = getSentenceAnnotation(sentId);
						colorSent = sent[0];
						noColorSent = sent[1];
						
                        // before the sentence, insert the [X] link,
                        // or nothing for the desktop reports
                        var pretext = "";
                        //
                        
                            //
                            pretext = "[<a href='javascript:removeSent(" + sentId + ")'>X</a>] ";
                            //
                        
                        //
                        // load the constructed text into two divs, one with color
                        // and one with just mark up
						var newDivC_On = document.createElement('div');
						newDivC_On.setAttribute('id', 'sent' + sentId + 'C_On');
						newDivC_On.innerHTML = pretext + colorSent;

						var newDivC_Off = document.createElement('div');
						newDivC_Off.setAttribute('id', 'sent' + sentId + 'C_Off');
						newDivC_Off.innerHTML = pretext + noColorSent;

                        // add the divs for this sentence to their respective
                        // parent sentence divs
						sentDivC_On.appendChild(newDivC_On);
						sentDivC_Off.appendChild(newDivC_Off);

                        showSents();
					}

                    //
                    
                    //
				}
                                
                /* GENERAL FUNCTIONS */

				// extract XML file name from URL
				function getURLFileName() {
					var wholeurl = window.location.href;
					var result = wholeurl.replace(/[?].*$/,"");
					return result;
				}

                // get the value of a paramater passed in through the url
                // like in '...lu3.xml?mode=lexentry'
				function gup(name) {
					name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
					var regexS = "[\\?&]"+name+"=([^&#]*)";
					var regex = new RegExp( regexS );
					var results = regex.exec( window.location.href );
					if( results == null )
						return "";
					else
						return results[1];
				}

                // create the navigation links at the top right of the report
				function navBar() {
					var linkDiv = document.createElement("div");
                    // float the link div to the right
                    linkDiv.style.cssFloat = "right"; // Firefox, Safari
                    linkDiv.style.styleFloat = "right"; // IE
                    var luLink = document.createElement("a");
                    // create Annotation link for Lexical Entry Report
                    if (mode == "lexentrytop") {
                        luLink.setAttribute("href",currentXMLFile+"?mode=annotation");
                        luLink.setAttribute("target","_parent");
                        luLink.innerHTML = "Annotation";
                    }
                    // create Lexical Entry link for Annotation Report
                    else if (mode == "" || mode == "annotation") {
                        luLink.setAttribute("href",currentXMLFile+"?mode=lexentry");
                        luLink.innerHTML = "Lexical Entry";
                    }
                    // create Frame link
                    var frameLink = document.createElement("a");
                    frameLink.setAttribute("href","../frameIndex.xml?frame=" + frameName);
                    if (mode != "" && mode != "annotation")
                        frameLink.setAttribute("target","_parent");
                    frameLink.innerHTML = frameName;
					linkDiv.appendChild(luLink);
					linkDiv.innerHTML += "<font style='padding:5px' />";
					// linkDiv.appendChild(frameLink);
					return linkDiv;
				}

                // used by Annotation Report to display all sentences
				function showAnnotation(targetDivId) {
                    // get the annotation for all of the sentences
                    var sentenceAnnot = getSentenceAnnotation("all");
                    // update the color and no color divs
					mainDivColor.innerHTML = sentenceAnnot[0];
                    mainDivNoColor.innerHTML = sentenceAnnot[1];
				}

                //* get the sentence annotation in the form of a colored sentence
                // and a marked up sentence
                //* sentId is actually an annotationSet ID or 'all'
                //* used by the Annotation Report and in the sentence frame of the
                // Lexical Entry Report
				function getSentenceAnnotation(sentId) {
					var sent;
                    var skipSent;
					var sentOrig;					
					var charLabelMap;
					var rank2, rank3;
					var sc_name;
					// [colorSent, noColorSent]
					var finalStr = ["", ""];
                    var actualsentId;
                    var cursentId;
					//
					var frameName = "Unk";
					//

                    // create an unordered list of all the subcorpora for Annotation Report
					if (sentId == "all") {
						finalStr[0] += "<ol>";
                        finalStr[1] += "<ol>";
                    }
					//
					
						//
                        // display subcorpora for Annotation Report
						if (sentId == "all") {
							//
							sc_name = "8_stories_09_M12";
							//
							ind = sc_name // .indexOf("-");
							// cuts off the material before the first "-" in the sc name: not always desirable
							sc_name = sc_name.substring(ind+1, sc_name.length);
							finalStr[0] += "<li><a target=\"_blank\" href=\"http://160.16.203.55/dev/cgi-bin/analysis.sh?file="+sc_name+"&db=Kainoki\">"+sc_name+"</a>";
                            finalStr[1] += "<li>"+sc_name;
						}

                        // populate maps of annotation labels to char positions
                        // in the sentence for each layer of annotation
                        // and for both colors and no colors
						//
						
                            actualsentId = "8_stories_09_M12";
							//

                            skipSent = true;

                            // have to escape all quotes in the sentOrig first, using XSL template at bottom
                            //
                            
                            sentOrig = "John knelt down to make it easier to clean the bulldog .";
                            
                            
                                cursentId = "11822";
                                //
                                // [colorSent, noColorSent] for each rank 1-3
                                sent = [["", ""], ["", ""], ["", ""]];
                                // simulate 6 maps (for each rank 1-3 and for color/noColor)
                                // with simple javascript object properties
                                charLabelMap = [[new Object(), new Object()],
                                    [new Object(), new Object()], [new Object(), new Object()]];
                                rank2 = false; // assume no rank 2 at first
                                rank3 = false; // assume no rank 3 at first

                                if (sentId == "all" || cursentId == sentId) {
                                    skipSent = false;
                                    //
                                    

                                        labelName = "arg0";
                                        rank = 1;
                                        //
                                        if (rank == 2)
                                            rank2 = true;
                                        else if (rank == 3)
                                            rank3 = true;
                                        else if (rank > 3) {
                                            // shouldn't happen: no case yet, but script could be edited to accomodate
                                            sentOrig += " ERROR: LABEL " + labelName + " HAS RANK > 3. THIS IS NOT " +
                                                "HANDLED YET (NO SUCH CASE WHEN SCRIPT WAS WRITTEN BUT COULD BE ADDED)";
                                        }

                                        // get the label data and store it in charLabelMap
                                        //
                                        
                                            start = "0";
                                            
                                            end = 3 + 1 + "";
                                            
                                                //
                                                if (rank < 4) { // should always be true
                                                    // color
                                                    insertMapValue(charLabelMap[rank-1][0], start,
                                                        "<span class='" + frameName + "-" + labelName + "'>", false);
                                                    insertMapValue(charLabelMap[rank-1][0], end, "</span>", true);

                                                    // no color
                                                    insertMapValue(charLabelMap[rank-1][1], start,
                                                        "[<sub>" + labelName + "</sub>", true);
                                                    insertMapValue(charLabelMap[rank-1][1], end, "]", false);

                                                }
                                                //
                                            

                                        labelName = "arg1";
                                        rank = 1;
                                        //
                                        if (rank == 2)
                                            rank2 = true;
                                        else if (rank == 3)
                                            rank3 = true;
                                        else if (rank > 3) {
                                            // shouldn't happen: no case yet, but script could be edited to accomodate
                                            sentOrig += " ERROR: LABEL " + labelName + " HAS RANK > 3. THIS IS NOT " +
                                                "HANDLED YET (NO SUCH CASE WHEN SCRIPT WAS WRITTEN BUT COULD BE ADDED)";
                                        }

                                        // get the label data and store it in charLabelMap
                                        //
                                        
                                            start = "34";
                                            
                                            end = 53 + 1 + "";
                                            
                                                //
                                                if (rank < 4) { // should always be true
                                                    // color
                                                    insertMapValue(charLabelMap[rank-1][0], start,
                                                        "<span class='" + frameName + "-" + labelName + "'>", false);
                                                    insertMapValue(charLabelMap[rank-1][0], end, "</span>", true);

                                                    // no color
                                                    insertMapValue(charLabelMap[rank-1][1], start,
                                                        "[<sub>" + labelName + "</sub>", true);
                                                    insertMapValue(charLabelMap[rank-1][1], end, "]", false);

                                                }
                                                //
                                            

                                        labelName = "prd";
                                        rank = 1;
                                        //
                                        if (rank == 2)
                                            rank2 = true;
                                        else if (rank == 3)
                                            rank3 = true;
                                        else if (rank > 3) {
                                            // shouldn't happen: no case yet, but script could be edited to accomodate
                                            sentOrig += " ERROR: LABEL " + labelName + " HAS RANK > 3. THIS IS NOT " +
                                                "HANDLED YET (NO SUCH CASE WHEN SCRIPT WAS WRITTEN BUT COULD BE ADDED)";
                                        }

                                        // get the label data and store it in charLabelMap
                                        //
                                        
                                            start = "27";
                                            
                                            end = 32 + 1 + "";
                                            
                                                //
                                                if (rank < 4) { // should always be true
                                                    // color
                                                    insertMapValue(charLabelMap[rank-1][0], start,
                                                        "<span class='" + frameName + "-" + labelName + "'>", false);
                                                    insertMapValue(charLabelMap[rank-1][0], end, "</span>", true);

                                                    // no color
                                                    insertMapValue(charLabelMap[rank-1][1], start,
                                                        "[<sub>" + labelName + "</sub>", true);
                                                    insertMapValue(charLabelMap[rank-1][1], end, "]", false);

                                                }
                                                //
                                            

                                        labelName = "Target";
                                        rank = 1;
                                        //
                                        if (rank == 2)
                                            rank2 = true;
                                        else if (rank == 3)
                                            rank3 = true;
                                        else if (rank > 3) {
                                            // shouldn't happen: no case yet, but script could be edited to accomodate
                                            sentOrig += " ERROR: LABEL " + labelName + " HAS RANK > 3. THIS IS NOT " +
                                                "HANDLED YET (NO SUCH CASE WHEN SCRIPT WAS WRITTEN BUT COULD BE ADDED)";
                                        }

                                        // get the label data and store it in charLabelMap
                                        //
                                        
                                            start = "19";
                                            
                                            end = 22 + 1 + "";
                                            
                                                //
                                                // color
                                                insertMapValue(charLabelMap[0][0], start, "<TARGET><span class='Target'>", false);
                                                insertMapValue(charLabelMap[0][0], end, "<TARGET></span>", true);
                                                // no color
                                                insertMapValue(charLabelMap[0][1], start, "<TARGET><span class='italic'>", true);
                                                insertMapValue(charLabelMap[0][1], end, "<TARGET></span><sup>Target</sup>", false);
                                                //
                                            
                                    //
                                    // apply the labels and display the sentence
                                    displaySentence(charLabelMap,  sent, sentOrig, sentId, finalStr, rank2, rank3, actualsentId);
                                }
                                //
                            
                            //
                            if (sentId == "all" || !skipSent) {
                                //
                                
                                //
                            }
                            //
                        
                        //
                        if (sentId == "all") {
                            finalStr[0] += "</li>";
                            finalStr[1] += "</li>";
                        }
                        //
					
						//
                        // display subcorpora for Annotation Report
						if (sentId == "all") {
							//
							sc_name = "9_stories_09_M12";
							//
							ind = sc_name // .indexOf("-");
							// cuts off the material before the first "-" in the sc name: not always desirable
							sc_name = sc_name.substring(ind+1, sc_name.length);
							finalStr[0] += "<li><a target=\"_blank\" href=\"http://160.16.203.55/dev/cgi-bin/analysis.sh?file="+sc_name+"&db=Kainoki\">"+sc_name+"</a>";
                            finalStr[1] += "<li>"+sc_name;
						}

                        // populate maps of annotation labels to char positions
                        // in the sentence for each layer of annotation
                        // and for both colors and no colors
						//
						
                            actualsentId = "9_stories_09_M12";
							//

                            skipSent = true;

                            // have to escape all quotes in the sentOrig first, using XSL template at bottom
                            //
                            
                            sentOrig = "The bulldog suddenly put its front paws on John , gave him a mighty push which sent him flat on his back , and started to lick him .";
                            
                            
                                cursentId = "11829";
                                //
                                // [colorSent, noColorSent] for each rank 1-3
                                sent = [["", ""], ["", ""], ["", ""]];
                                // simulate 6 maps (for each rank 1-3 and for color/noColor)
                                // with simple javascript object properties
                                charLabelMap = [[new Object(), new Object()],
                                    [new Object(), new Object()], [new Object(), new Object()]];
                                rank2 = false; // assume no rank 2 at first
                                rank3 = false; // assume no rank 3 at first

                                if (sentId == "all" || cursentId == sentId) {
                                    skipSent = false;
                                    //
                                    

                                        labelName = "arg0";
                                        rank = 1;
                                        //
                                        if (rank == 2)
                                            rank2 = true;
                                        else if (rank == 3)
                                            rank3 = true;
                                        else if (rank > 3) {
                                            // shouldn't happen: no case yet, but script could be edited to accomodate
                                            sentOrig += " ERROR: LABEL " + labelName + " HAS RANK > 3. THIS IS NOT " +
                                                "HANDLED YET (NO SUCH CASE WHEN SCRIPT WAS WRITTEN BUT COULD BE ADDED)";
                                        }

                                        // get the label data and store it in charLabelMap
                                        //
                                        
                                            start = "73";
                                            
                                            end = 77 + 1 + "";
                                            
                                                //
                                                if (rank < 4) { // should always be true
                                                    // color
                                                    insertMapValue(charLabelMap[rank-1][0], start,
                                                        "<span class='" + frameName + "-" + labelName + "'>", false);
                                                    insertMapValue(charLabelMap[rank-1][0], end, "</span>", true);

                                                    // no color
                                                    insertMapValue(charLabelMap[rank-1][1], start,
                                                        "[<sub>" + labelName + "</sub>", true);
                                                    insertMapValue(charLabelMap[rank-1][1], end, "]", false);

                                                }
                                                //
                                            

                                        labelName = "arg1";
                                        rank = 1;
                                        //
                                        if (rank == 2)
                                            rank2 = true;
                                        else if (rank == 3)
                                            rank3 = true;
                                        else if (rank > 3) {
                                            // shouldn't happen: no case yet, but script could be edited to accomodate
                                            sentOrig += " ERROR: LABEL " + labelName + " HAS RANK > 3. THIS IS NOT " +
                                                "HANDLED YET (NO SUCH CASE WHEN SCRIPT WAS WRITTEN BUT COULD BE ADDED)";
                                        }

                                        // get the label data and store it in charLabelMap
                                        //
                                        
                                            start = "84";
                                            
                                            end = 86 + 1 + "";
                                            
                                                //
                                                if (rank < 4) { // should always be true
                                                    // color
                                                    insertMapValue(charLabelMap[rank-1][0], start,
                                                        "<span class='" + frameName + "-" + labelName + "'>", false);
                                                    insertMapValue(charLabelMap[rank-1][0], end, "</span>", true);

                                                    // no color
                                                    insertMapValue(charLabelMap[rank-1][1], start,
                                                        "[<sub>" + labelName + "</sub>", true);
                                                    insertMapValue(charLabelMap[rank-1][1], end, "]", false);

                                                }
                                                //
                                            

                                        labelName = "prd";
                                        rank = 1;
                                        //
                                        if (rank == 2)
                                            rank2 = true;
                                        else if (rank == 3)
                                            rank3 = true;
                                        else if (rank > 3) {
                                            // shouldn't happen: no case yet, but script could be edited to accomodate
                                            sentOrig += " ERROR: LABEL " + labelName + " HAS RANK > 3. THIS IS NOT " +
                                                "HANDLED YET (NO SUCH CASE WHEN SCRIPT WAS WRITTEN BUT COULD BE ADDED)";
                                        }

                                        // get the label data and store it in charLabelMap
                                        //
                                        
                                            start = "88";
                                            
                                            end = 103 + 1 + "";
                                            
                                                //
                                                if (rank < 4) { // should always be true
                                                    // color
                                                    insertMapValue(charLabelMap[rank-1][0], start,
                                                        "<span class='" + frameName + "-" + labelName + "'>", false);
                                                    insertMapValue(charLabelMap[rank-1][0], end, "</span>", true);

                                                    // no color
                                                    insertMapValue(charLabelMap[rank-1][1], start,
                                                        "[<sub>" + labelName + "</sub>", true);
                                                    insertMapValue(charLabelMap[rank-1][1], end, "]", false);

                                                }
                                                //
                                            

                                        labelName = "Target";
                                        rank = 1;
                                        //
                                        if (rank == 2)
                                            rank2 = true;
                                        else if (rank == 3)
                                            rank3 = true;
                                        else if (rank > 3) {
                                            // shouldn't happen: no case yet, but script could be edited to accomodate
                                            sentOrig += " ERROR: LABEL " + labelName + " HAS RANK > 3. THIS IS NOT " +
                                                "HANDLED YET (NO SUCH CASE WHEN SCRIPT WAS WRITTEN BUT COULD BE ADDED)";
                                        }

                                        // get the label data and store it in charLabelMap
                                        //
                                        
                                            start = "79";
                                            
                                            end = 82 + 1 + "";
                                            
                                                //
                                                // color
                                                insertMapValue(charLabelMap[0][0], start, "<TARGET><span class='Target'>", false);
                                                insertMapValue(charLabelMap[0][0], end, "<TARGET></span>", true);
                                                // no color
                                                insertMapValue(charLabelMap[0][1], start, "<TARGET><span class='italic'>", true);
                                                insertMapValue(charLabelMap[0][1], end, "<TARGET></span><sup>Target</sup>", false);
                                                //
                                            
                                    //
                                    // apply the labels and display the sentence
                                    displaySentence(charLabelMap,  sent, sentOrig, sentId, finalStr, rank2, rank3, actualsentId);
                                }
                                //
                            
                            //
                            if (sentId == "all" || !skipSent) {
                                //
                                
                                //
                            }
                            //
                        
                        //
                        if (sentId == "all") {
                            finalStr[0] += "</li>";
                            finalStr[1] += "</li>";
                        }
                        //
					
					//
					if (sentId == "all") {
						finalStr[0] += "</ol>";
                        finalStr[1] += "</ol>";
                    }
					return finalStr;
				}

                function displaySentence(charLabelMap,  sent, sentOrig, sentId, finalStr, rank2, rank3, actualsentId) {
                    // apply color labels in charLabelMap to sent
                    sent = applyLabelsToSent(charLabelMap, sent, sentOrig, 0);

                    // apply non-color labels in charLabelMap to sent
                    sent = applyLabelsToSent(charLabelMap, sent, sentOrig, 1);

                    // construct finalStr from sent
                    if (sentId == "all") {
                        finalStr[0] += "<br/>";
                        finalStr[1] += "<br/>";
                    }

                    // color
                    finalStr[0] += sent[0][0];
                    var invisSpan = "<br /><span class='invisible'>"
                    if (rank2) {
                        //
                        
                            //
                            // display differences between annotation/lexentry
                            if (sentId == "all")
                                finalStr[0] += invisSpan + sent[1][0] + "</span>";
                            else
                                finalStr[0] += invisSpan + "[X] " + sent[1][0] + "</span>";
                            //
                        
                        //
                    }
                    if (rank3) {
                        //
                        
                            //
                            // display differences between annotation/lexentry
                            if (sentId == "all")
                                finalStr[0] += invisSpan + sent[2][0] + "</span>";
                            else
                                finalStr[0] += invisSpan + "[X] " + sent[2][0] + "</span>";
                            //
                        
                        //
                    }
                    //
                    
                    //

                    // no color
                    finalStr[1] += sent[0][1];
                    if (rank2) {
                        if (sentId == "all")
                            finalStr[1] += invisSpan + sent[1][1] + "</span>";
                        else
                            finalStr[1] += invisSpan + "[X] " + sent[1][1] + "</span>";
                    }
                    if (rank3) {
                        if (sentId == "all")
                            finalStr[1] += invisSpan + sent[2][1] + "</span>";
                        else
                            finalStr[1] += invisSpan + "[X] " + sent[2][1] + "</span>";
                    }

                    if (sentId == "all") {
                        finalStr[0] += "</li>";
                        finalStr[1] += "</li>";
                    }
                }

                // insert a value for a key into a javascript object
				function insertMapValue(map, key, value, toTheEnd) {
					if (!map[key])
						map[key] = value;
					else if (toTheEnd) // insert at end
						map[key] += value;
					else // insert at beginning
						map[key] = value + map[key];
				}

                // go through the sentence text and insert the labels (span classes)
				function applyLabelsToSent(charLabelMap, sent, sentOrig, noColor) {
					// noColor is 0 or 1
					var inTarget; // tracks whether in target tag
					for (var i = 0; i < sentOrig.length + 1; i++) {
						// get labels for this char at i
						var charLabels = [charLabelMap[0][noColor]["" + i],
										  charLabelMap[1][noColor]["" + i],
										  charLabelMap[2][noColor]["" + i]]
						// rank 1
						if (charLabels[0]) {
							var targetIndex = charLabels[0].indexOf("<TARGET>");
							if (targetIndex != -1) {
								// found target tag
								inTarget = !inTarget;
								// remove special target tag
								charLabels[0] = charLabels[0].substring(0, targetIndex) +
									charLabels[0].substring(targetIndex + 8, charLabels[0].length);
							}
							sent[0][noColor] += charLabels[0];
						}
						
						// close and open invisible span for ranks 2 and 3
						for (var r = 1; r < 3; r++) {
							if (charLabels[r]) {
								if (charLabels[r] == "</span>" || charLabels[r] == "]")
									sent[r][noColor] += charLabels[r] + "<span class='invisible'>";
								else
									sent[r][noColor] += "</span>" + charLabels[r];
							}
						}

                        // have to check 1 past the length but don't add characters past the length
                        if (i < sentOrig.length) {
                            var sentChar = sentOrig.charAt(i);
                            if (inTarget)
                                sentChar = sentChar.toUpperCase();
                            sent[0][noColor] += sentChar;
                            sent[1][noColor] += sentChar;
                            sent[2][noColor] += sentChar;
                        }
					}
					if (charLabelMap[0][noColor]["itype"])
						sent[0][noColor] += charLabelMap[0][noColor]["itype"];
					return sent;					
				}

                // the link on sentence counts to add sentences to the bottom
                // sentence frame depends on the internal mode
                function getAddSentLink(idList) {
                    //
                    
                        //
                        return "<a href='javascript:addSent(" + idList + ")'>";
                        //
                    
                    //
                }

                // get the Lexical Entry data for the top frame of the Lexical Entry Report
				function showLexEntry(targetDivId) {
                    // get basic LU info
					//
					var luName = "make;send";
					var frName = "Unk";
					
					var luDef = "make.v; send.v";
                    var incFE = "";
                    var luSemType = "";
                    

                    //
                    // get lists of support words
                    var governors = "";
                    var supports = "";
                    var controllers = "";
                    // get governor data
                    //
                    
					//
                    // create a div storing the lu info and support words
					var luInfoDiv = document.createElement('div');
					luInfoDiv.innerHTML = "<h1>Lexical Entry</h1>" +
                                             "<h1>" + luName // + "</h1>" + "<h3>Frame: " + frName + "</h3>" + "<h4>Definition:</h4>" + luDef + "<br />";
                    if (luSemType != "")
                        luInfoDiv.innerHTML += "<br /><b>Semantic Type: </b>" +
                                                  luSemType + "<br />";
                    if (governors.length > 0)
                        luInfoDiv.innerHTML += "<br />" + "<b>Governor(s):</b> " + governors;
                    if (supports.length > 0)
                        luInfoDiv.innerHTML += "<br />" + "<b>Support(s):</b> " + supports;
                    if (controllers.length > 0)
                        luInfoDiv.innerHTML += "<br />" + "<b>Controller(s):</b> " + controllers;

                    if (incFE) {
                        if (governors.length > 0 || supports.length > 0 || controllers.length > 0)
                            luInfoDiv.innerHTML += "<br />";
                        luInfoDiv.innerHTML += "<br /><b>Incorporated FE: </b>" +
                                               "<span class='" + frName + "-" + incFE + "'>" + incFE + "</span>";
                    }
                    
                    luInfoDiv.innerHTML += "<h3>Roles and Their Syntactic Realisations</h3>" +
											 "The Roles for this word are (with realisations):";

                    // FE Realizations
					var colors = new Array();
					var fes = new Array();
					var finalStr = "<p />";
					finalStr += "<table class='feReal'>";
					finalStr += "<tr><th>Role</th><th>Number Annotated</th><th>Realisation(s)</th></tr>";
					var sum = 0;
					var curFE = "";
					//
					
						curFE = "arg1";
						curSum = "2";
						idList = "";
						
							idList += "\"11829\",";
						
							idList += "\"11822\",";
						
						//
						idList = idList.substring(0,idList.length-1);
						finalStr += "<tr><td><span class='" + frName + "-" + curFE + "'>" + curFE +
							"</span></td>";
						finalStr += "<td>(" + getAddSentLink(idList) +
							curSum + "</a>)</td>";
						finalStr += "<td>";
						//
						
							fe = "arg1";
							pt = "NP-OB1";
							gf = "Obj";
							//
							if (gf == ""){
								gf = "--";
							}
							//
							sum = "1";
							idList = "";
							
								idList += "\"11829\",";
							
							//
							idList = idList.substring(0,idList.length-1);
							finalStr += pt + "." + gf;
							finalStr += " (" + getAddSentLink(idList) +
								sum + "</a>)<br />";
							//
						
							fe = "arg1";
							pt = "IP-INF2-NOB1";
							gf = "Obj";
							//
							if (gf == ""){
								gf = "--";
							}
							//
							sum = "1";
							idList = "";
							
								idList += "\"11822\",";
							
							//
							idList = idList.substring(0,idList.length-1);
							finalStr += pt + "." + gf;
							finalStr += " (" + getAddSentLink(idList) +
								sum + "</a>)<br />";
							//
						
						//
						finalStr += "</td></tr>";
						//
					
						curFE = "prd";
						curSum = "2";
						idList = "";
						
							idList += "\"11822\",";
						
							idList += "\"11829\",";
						
						//
						idList = idList.substring(0,idList.length-1);
						finalStr += "<tr><td><span class='" + frName + "-" + curFE + "'>" + curFE +
							"</span></td>";
						finalStr += "<td>(" + getAddSentLink(idList) +
							curSum + "</a>)</td>";
						finalStr += "<td>";
						//
						
							fe = "prd";
							pt = "ADJP-PRD";
							gf = "Dep";
							//
							if (gf == ""){
								gf = "--";
							}
							//
							sum = "2";
							idList = "";
							
								idList += "\"11822\",";
							
								idList += "\"11829\",";
							
							//
							idList = idList.substring(0,idList.length-1);
							finalStr += pt + "." + gf;
							finalStr += " (" + getAddSentLink(idList) +
								sum + "</a>)<br />";
							//
						
						//
						finalStr += "</td></tr>";
						//
					
						curFE = "arg0";
						curSum = "2";
						idList = "";
						
							idList += "\"11822\",";
						
							idList += "\"11829\",";
						
						//
						idList = idList.substring(0,idList.length-1);
						finalStr += "<tr><td><span class='" + frName + "-" + curFE + "'>" + curFE +
							"</span></td>";
						finalStr += "<td>(" + getAddSentLink(idList) +
							curSum + "</a>)</td>";
						finalStr += "<td>";
						//
						
							fe = "arg0";
							pt = "NP-SBJ";
							gf = "Ext";
							//
							if (gf == ""){
								gf = "--";
							}
							//
							sum = "2";
							idList = "";
							
								idList += "\"11822\",";
							
								idList += "\"11829\",";
							
							//
							idList = idList.substring(0,idList.length-1);
							finalStr += pt + "." + gf;
							finalStr += " (" + getAddSentLink(idList) +
								sum + "</a>)<br />";
							//
						
						//
						finalStr += "</td></tr>";
						//
					
					//
					finalStr += "</table>";

					var feTable = document.createElement('div');
					feTable.setAttribute('id', 'feTable');
					feTable.innerHTML = finalStr;

					// FE Group Realizations
					// need to find out what is the maximum number of FEs in any realization group is
                    var maxFEGroupSize = 0;
					//
					
							maxFEGroupSize = 3;
						
					//
					finalStr = "<h3>Valence Patterns:</h3>";
					finalStr += "These roles occur in the following syntactic patterns: <p />";
					finalStr += "<table class='feGReal'>";
					finalStr += "<tr><th>Number Annotated</th><th colspan='" + maxFEGroupSize +
						"'>Patterns</th></tr>";
					//
					var numFEs;
					
						idList = "";
						
							idList += "\"11822\",";
						
							idList += "\"11829\",";
						
						//
						idList = idList.substring(0,idList.length-1);
						//
						curSum = "2";
						//
						finalStr += "<tr><td class='totals'>";
						finalStr += getAddSentLink(idList) + curSum + "</a> TOTAL";
						finalStr += "</td>";
						var j = 0;
						numFEs = 0;
						//
						
							//
							numFEs++;
							//
							fe = "arg0";
							//
							finalStr += "<td><span class='"+frName+"-"+fe+"'>"+fe+"</span></td>";
							//
						
							//
							numFEs++;
							//
							fe = "arg1";
							//
							finalStr += "<td><span class='"+frName+"-"+fe+"'>"+fe+"</span></td>";
							//
						
							//
							numFEs++;
							//
							fe = "prd";
							//
							finalStr += "<td><span class='"+frName+"-"+fe+"'>"+fe+"</span></td>";
							//
						
						//
						for (var i = numFEs; i < maxFEGroupSize; i++){
							finalStr += "<td><br /></td>";
						}
						finalStr += "</tr>";
						//
						
							idList = "";
							
								idList += "\"11822\",";
							
							idList = idList.substring(0,idList.length-1);
							sum = "1";
							//
							finalStr += "<tr><td class='totals'> (";
							finalStr += getAddSentLink(idList) + sum + "</a>";
							finalStr += ") </td>";
							numFEs = 0;
							//
							
								//
								numFEs++;
								//
								pt = "NP-SBJ";
								gf = "Ext";
								//
								if (gf == ""){
									gf = "--";
								}
								finalStr += "<td>" + pt + "<br />" + gf + "</td>";
								//
							
								//
								numFEs++;
								//
								pt = "IP-INF2-NOB1";
								gf = "Obj";
								//
								if (gf == ""){
									gf = "--";
								}
								finalStr += "<td>" + pt + "<br />" + gf + "</td>";
								//
							
								//
								numFEs++;
								//
								pt = "ADJP-PRD";
								gf = "Dep";
								//
								if (gf == ""){
									gf = "--";
								}
								finalStr += "<td>" + pt + "<br />" + gf + "</td>";
								//
							
							//
							for (var i = numFEs; i < maxFEGroupSize; i++){
								finalStr += "<td><br /></td>";
							}
							finalStr += "</tr>";
							//
						
							idList = "";
							
								idList += "\"11829\",";
							
							idList = idList.substring(0,idList.length-1);
							sum = "1";
							//
							finalStr += "<tr><td class='totals'> (";
							finalStr += getAddSentLink(idList) + sum + "</a>";
							finalStr += ") </td>";
							numFEs = 0;
							//
							
								//
								numFEs++;
								//
								pt = "NP-SBJ";
								gf = "Ext";
								//
								if (gf == ""){
									gf = "--";
								}
								finalStr += "<td>" + pt + "<br />" + gf + "</td>";
								//
							
								//
								numFEs++;
								//
								pt = "NP-OB1";
								gf = "Obj";
								//
								if (gf == ""){
									gf = "--";
								}
								finalStr += "<td>" + pt + "<br />" + gf + "</td>";
								//
							
								//
								numFEs++;
								//
								pt = "ADJP-PRD";
								gf = "Dep";
								//
								if (gf == ""){
									gf = "--";
								}
								finalStr += "<td>" + pt + "<br />" + gf + "</td>";
								//
							
							//
							for (var i = numFEs; i < maxFEGroupSize; i++){
								finalStr += "<td><br /></td>";
							}
							finalStr += "</tr>";
							//
						
					//
					finalStr += "</table>";

					var patternTable = document.createElement('div');
					patternTable.setAttribute('id', 'patternTable');
					patternTable.innerHTML = finalStr;

					var targetDiv = document.getElementById(targetDivId);
					targetDiv.appendChild(luInfoDiv);
					targetDiv.appendChild(feTable);
					targetDiv.appendChild(patternTable);
				}
				//
			</script>
</head></html>
